<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antsy Records</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/desktop.css">
    <link rel="stylesheet" href="css/windows.css">
    <link rel="stylesheet" href="css/catalog.css">
    <link rel="stylesheet" href="css/markdown.css">
    <link rel="stylesheet" href="css/tooltips.css">
    <link rel="stylesheet" href="css/ticker.css">
    <link rel="stylesheet" href="css/media.css"> <!-- Responsive support -->
    <link rel="stylesheet" href="css/player.css"> <!-- Music Player UI -->
    <link rel="stylesheet" href="css/settings.css"> <!-- Settings UI -->

    <!-- Markdown Support -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Core Managers -->
    <script defer src="js/dragManager.js"></script>
    <script defer src="js/windowManager.js"></script>
    <script defer src="js/iconManager.js"></script> <!-- Must load before iconHandler -->
    <script defer src="js/iconHandler.js"></script>
    <script defer src="js/resizeHandler.js"></script>

    <!-- Window and Content Loaders -->
    <script type="module">
        import "./js/catalogWindow.js";
        import "./js/playerWindow.js";
        import "./js/bandcampEmbed.js";
        import "./js/settings.js";
    </script>    

    <!-- ‚úÖ Ensure Proper Initialization -->
    <script defer>
        document.addEventListener("DOMContentLoaded", async () => {
            console.log("‚úÖ Ensuring Proper Initialization...");

            // Ensure all core functions exist before calling them
            if (typeof initializeDragManager === "function") {
                initializeDragManager(); // Ensure icons are draggable
            } else {
                console.error("‚ùå initializeDragManager() is not defined!");
            }

            if (typeof initializeIcons === "function") {
                initializeIcons(); // Ensure correct icon positioning
            } else {
                console.error("‚ùå initializeIcons() is not defined!");
            }

            if (typeof updateIconSizes === "function") {
                updateIconSizes(); // Apply user settings
            } else {
                console.error("‚ùå updateIconSizes() is not defined!");
            }

            // Ensure module-based functions load dynamically
            try {
                const { initializeWindows } = await import("./js/windowManager.js");
                initializeWindows();
            } catch (err) {
                console.error("‚ùå Failed to load windowManager module:", err);
            }
        });
    </script>

</head>
<body>
    <div id="background-overlay"></div>

    <!-- Desktop Container (Ensures icons stay within window limits) -->
    <div id="desktop-container">
        <div id="desktop">
            <!-- üéµ Music Catalog Folder -->
            <div class="icon" data-file="music-catalog">
                <img src="icons/folder-music.png" alt="Music Catalog">
                <span>Music Catalog</span>
            </div>

            <!-- ‚ÑπÔ∏è About Icon -->
            <div class="icon" data-file="about">
                <img src="icons/about.png" alt="About">
                <span>About</span>
            </div>

            <!-- ‚öôÔ∏è Settings Icon -->
            <div class="icon" data-file="settings">
                <img src="icons/settings.png" alt="Settings">
                <span>Settings</span>
            </div>

            <!-- üåê Seamless Navigation Between Seigr Subdomains -->
            <div class="icon shortcut" data-url="http://sonisk.seigr.net">
                <img src="icons/audio.png" alt="Sonisk">
                <span>Sonisk Seigr</span>
            </div>

            <div class="icon shortcut" data-url="http://seigr.net">
                <img src="icons/seigr.png" alt="Seigr">
                <span>Seigr</span>
            </div>
        </div>
    </div>

    <!-- Window Container -->
    <div id="window-container"></div>

    <!-- ‚úÖ Scrolling Ticker -->
    <div id="ticker-container">
        <div id="ticker">üöß Site Under Construction üöß</div>
    </div>

</body>
</html>
